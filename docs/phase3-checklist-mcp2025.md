# LRMM Phase 3 체크리스트: MCP 서버 및 LangGraph 통합 (2025 업데이트)

> 기간: Week 2
> 목표: 최신 MCP 사양을 반영한 서버 구현 및 LangGraph 통합
> ⚠️ 2025년 5월 MCP 변경사항 반영

## 사전 요구사항
- [ ] Phase 1, 2 완료 및 검증
- [ ] FastMCP 라이브러리 최신 버전 설치
- [ ] MCP 2025 사양 문서 숙지
- [ ] JSON-RPC 프로토콜 이해
- [ ] LangGraph 기본 개념 숙지

---

## 단위작업 3.1: MCP 서버 기본 구조 (JSON-RPC 기반)

### 목표
최신 MCP 사양에 맞춰 JSON-RPC 기반 서버를 구성하고 5가지 프리미티브를 준비한다.

### 구현 사항
- [ ] `src/server.py` 생성 (JSON-RPC 핸들러 포함)
- [ ] FastMCP 앱 인스턴스 생성
- [ ] JSON-RPC 메시지 핸들러 구현
  - request/response 구조
  - error 핸들링
  - id 기반 메시지 추적
- [ ] 서버 메타데이터 설정
  - name: "LRMM Memory Server"
  - version: "1.0.0"
  - capabilities 명시
- [ ] 프리미티브 구조 준비
  - Tools (기존)
  - Prompts (신규)
  - Resources (신규)

### 유효성 검사
- [ ] JSON-RPC 2.0 사양 준수
- [ ] 메시지 스키마 검증
- [ ] 프리미티브 타입 정확성

### 테스트
- [ ] JSON-RPC 통신 테스트
- [ ] 에러 응답 형식 검증
- [ ] 프리미티브 등록 확인

### 완료 기준
- [ ] JSON-RPC 통신 작동
- [ ] 모든 프리미티브 타입 지원
- [ ] 메시지 검증 통과

---

## 단위작업 3.2: memory 도구 구현 (Tools 프리미티브)

### 목표
memory 도구를 MCP Tools 프리미티브로 구현하고 보안 레이어를 추가한다.

### 구현 사항
- [ ] @mcp.tool() 데코레이터로 등록
- [ ] 도구 메타데이터 정의
  - description: 명확한 동작 설명
  - inputSchema: JSON Schema 정의
  - dangerous: 위험 플래그 설정
- [ ] 실행 전 동의 메커니즘
  - 도구 실행 요청 로깅
  - 위험 작업 경고
  - 동의 확인 (future: UI 통합)
- [ ] 파라미터 검증 강화
  - JSON Schema 기반 검증
  - 타입 안전성 보장

### 유효성 검사
- [ ] 도구 설명 명확성
- [ ] 스키마 완전성
- [ ] 보안 경고 적절성

### 테스트
- [ ] 도구 호출 보안 테스트
- [ ] 스키마 검증 테스트
- [ ] 권한 체크 테스트

### 완료 기준
- [ ] 보안 동의 메커니즘 구현
- [ ] 모든 액션 문서화
- [ ] 스키마 검증 100%

---

## 단위작업 3.3: Prompts와 Resources 프리미티브 구현

### 목표
MCP의 새로운 프리미티브인 Prompts와 Resources를 구현한다.

### 구현 사항
- [ ] Prompts 프리미티브
  - 프롬프트 템플릿 관리
  - 동적 프롬프트 생성
  - 컨텍스트별 프롬프트 제공
- [ ] Resources 프리미티브
  - 구조화된 데이터 노출
  - 메모리 콘텐츠를 리소스로 변환
  - URI 기반 리소스 식별
- [ ] 프리미티브 라우팅
  - 타입별 핸들러 분기
  - 통합 응답 포맷

### 유효성 검사
- [ ] 프롬프트 템플릿 유효성
- [ ] 리소스 URI 형식
- [ ] 데이터 구조 일관성

### 테스트
- [ ] 프롬프트 생성 테스트
- [ ] 리소스 조회 테스트
- [ ] 프리미티브 통합 테스트

### 완료 기준
- [ ] 3가지 서버 프리미티브 완성
- [ ] 통합 테스트 통과
- [ ] API 문서화 완료

---

## 단위작업 3.4: state 도구 및 양방향 통신

### 목표
state 도구를 구현하고 양방향 통신을 지원한다.

### 구현 사항
- [ ] StateManager 양방향 통신 지원
  - 서버→클라이언트 알림
  - 상태 변경 이벤트
  - 실시간 업데이트
- [ ] Sampling 프리미티브 대응
  - 클라이언트 요청 처리
  - Human-in-the-loop 구현
  - 승인/거부 메커니즘
- [ ] 스트리밍 지원
  - 긴 작업 실시간 업데이트
  - 진행 상황 보고
  - 중단 가능한 작업

### 유효성 검사
- [ ] 양방향 메시지 무결성
- [ ] 이벤트 순서 보장
- [ ] 타임아웃 처리

### 테스트
- [ ] 양방향 통신 테스트
- [ ] 스트리밍 성능 테스트
- [ ] 동시성 테스트

### 완료 기준
- [ ] 실시간 상태 업데이트
- [ ] 안정적인 양방향 통신
- [ ] Human-in-the-loop 작동

---

## 단위작업 3.5: 원격 연결 준비 및 인증

### 목표
향후 원격 MCP 연결을 위한 인증 시스템을 준비한다.

### 구현 사항
- [ ] 인증 레이어 설계
  - OAuth 2.0 플로우 준비
  - API 키 인증 (현재)
  - 토큰 관리 시스템
- [ ] 권한 시스템
  - 도구별 권한 설정
  - 사용자/그룹 관리
  - 권한 상속 구조
- [ ] 연결 보안
  - TLS 지원 준비
  - 연결 암호화
  - 세션 관리

### 유효성 검사
- [ ] 인증 토큰 유효성
- [ ] 권한 매트릭스 완전성
- [ ] 보안 프로토콜 준수

### 테스트
- [ ] 인증 플로우 테스트
- [ ] 권한 검증 테스트
- [ ] 보안 취약점 스캔

### 완료 기준
- [ ] 인증 시스템 프로토타입
- [ ] 권한 관리 작동
- [ ] 보안 문서화 완료

---

## 단위작업 3.6: MCP 서버 실행 및 통합 테스트

### 목표
최신 사양을 반영한 MCP 서버를 실행하고 Claude Desktop과 통합한다.

### 구현 사항
- [ ] 서버 진입점 업데이트
  - JSON-RPC 서버 시작
  - 프리미티브 초기화
  - 보안 체크
- [ ] Claude Desktop 설정 업데이트
  - config.json 최신 형식
  - 프리미티브 선언
  - 권한 설정
- [ ] 디버깅 도구
  - MCP Inspector 활용
  - 메시지 로깅
  - 성능 모니터링

### 유효성 검사
- [ ] 프로토콜 호환성
- [ ] 메시지 형식 검증
- [ ] 통합 안정성

### 테스트
- [ ] End-to-end 테스트
- [ ] Claude Desktop 통합
- [ ] 스트레스 테스트
- [ ] 보안 테스트

### 완료 기준
- [ ] 모든 기능 작동
- [ ] Claude Desktop 완전 통합
- [ ] 성능 목표 달성
- [ ] 보안 요구사항 충족

---

## Phase 3 완료 체크리스트

### 산출물
- [ ] JSON-RPC 기반 MCP 서버
- [ ] 5가지 프리미티브 구현
- [ ] 양방향 통신 시스템
- [ ] 보안 및 인증 레이어
- [ ] Claude Desktop 통합

### 품질 지표
- [ ] MCP 2025 사양 100% 준수
- [ ] 모든 보안 체크 통과
- [ ] 응답 시간 < 50ms
- [ ] 테스트 커버리지 > 90%

### 문서화
- [ ] API 문서 (OpenAPI 3.0)
- [ ] 보안 가이드라인
- [ ] 프리미티브 사용 예제
- [ ] 마이그레이션 가이드

### 다음 단계 준비
- [ ] Remote MCP 아키텍처 검토
- [ ] 멀티모달 지원 계획
- [ ] 성능 최적화 전략

---

작성일: 2025-05-27
작성자: 1호
버전: 3.0 (MCP 2025 사양 반영) 🚀✨
