# LRMM Phase 2 체크리스트: 핵심 메모리 엔진 (개정판)

> 기간: Day 4-7
> 목표: m_memory() 명령어의 핵심 로직 구현

## 사전 요구사항
- [ ] Phase 1 완료 및 검증
- [ ] Redis Stack 정상 작동
- [ ] 개발 환경 준비 완료

---

## 단위작업 2.1: 시간 기반 경로 시스템

### 목표
메모리 저장 시 자동으로 시간 기반 경로를 생성하고 파싱하는 유틸리티를 구현한다.

### 구현 사항
- [ ] TimePathGenerator 클래스 구현
  - 현재 시간 기반 경로 생성
  - 시간대(timezone) 처리
  - 카테고리 결합 로직
- [ ] 경로 파싱 기능
  - 날짜/시간 추출
  - 정규식 패턴 매칭
  - 시간 범위 계산
- [ ] 타임스탬프 변환 유틸리티

### 유효성 검사
- [ ] 시간대 처리 정확성
- [ ] 경로 형식 일관성
- [ ] 날짜 파싱 오류 처리

### 테스트
- [ ] 경로 생성 테스트
- [ ] 경로 파싱 테스트
- [ ] 시간대 변환 테스트
- [ ] 엣지 케이스 처리

### 완료 기준
- [ ] 모든 시간 형식 지원
- [ ] 테스트 커버리지 > 90%
- [ ] 성능 벤치마크 통과

---

## 단위작업 2.2: 메모리 데이터 모델

### 목표
메모리 시스템에서 사용할 데이터 모델을 정의하고 검증 로직을 구현한다.

### 구현 사항
- [ ] 기본 데이터 모델 정의
  - MemoryContent (기본 구조)
  - ConversationMessage (대화용)
  - SearchQuery (검색용)
  - MemoryKey (키 생성용)
- [ ] Enum 타입 정의
  - MemoryType (conversation, document, state 등)
  - SearchType (keyword, semantic, hybrid 등)
- [ ] 직렬화/역직렬화 메서드
- [ ] 데이터 검증 로직

### 유효성 검사
- [ ] 타입 안정성 확보
- [ ] 필수 필드 검증
- [ ] 데이터 무결성 체크

### 테스트
- [ ] 모델 생성 테스트
- [ ] 직렬화 왕복 테스트
- [ ] 검증 로직 테스트
- [ ] 엣지 케이스 처리

### 완료 기준
- [ ] 모든 모델 구현 완료
- [ ] 100% 타입 커버리지
- [ ] 검증 로직 완성

---

## 단위작업 2.3: 메모리 엔진 핵심

### 목표
m_memory() 명령어의 핵심 비즈니스 로직을 담당하는 MemoryEngine을 구현한다.

### 구현 사항
- [ ] MemoryEngine 클래스 구현
  - save: 메모리 저장
  - get: 메모리 조회
  - search: 메모리 검색
  - update: 메모리 수정
  - delete: 메모리 삭제
- [ ] 액션 라우팅 로직
- [ ] 데이터 타입별 처리 분기
- [ ] TTL 관리 로직

### 유효성 검사
- [ ] 액션 파라미터 검증
- [ ] 경로 형식 검증
- [ ] 권한 체크 (향후 확장)

### 테스트
- [ ] 각 액션별 단위 테스트
- [ ] 통합 시나리오 테스트
- [ ] 에러 처리 테스트
- [ ] 동시성 테스트

### 완료 기준
- [ ] 모든 기본 액션 구현
- [ ] 에러 처리 완성
- [ ] API 일관성 확보
- [ ] 성능 목표 달성

---

## 단위작업 2.4: Redis 데이터 구조 활용

### 목표
메모리 타입에 따라 적절한 Redis 데이터 구조를 선택하여 저장한다.

### 구현 사항
- [ ] 대화형 데이터 → Redis Streams
  - 시간순 메시지 저장
  - 자동 ID 생성
  - 범위 조회 지원
- [ ] 구조화 데이터 → RedisJSON
  - 복잡한 JSON 구조 저장
  - 부분 업데이트 지원
  - JSONPath 쿼리
- [ ] 메타데이터 → Redis Hash
  - 빠른 필드 접근
  - 원자적 업데이트

### 유효성 검사
- [ ] 데이터 타입 매칭 정확성
- [ ] 저장 형식 일관성
- [ ] 조회 성능 검증

### 테스트
- [ ] 각 데이터 구조별 CRUD
- [ ] 대용량 데이터 처리
- [ ] 메모리 효율성 측정
- [ ] 동시 접근 테스트

### 완료 기준
- [ ] 모든 데이터 타입 지원
- [ ] 최적 성능 달성
- [ ] 데이터 무손실 보장

---

## 단위작업 2.5: 기본 검색 기능

### 목표
키워드 및 시간 기반 검색 기능을 구현한다.

### 구현 사항
- [ ] 키워드 검색
  - 패턴 매칭
  - 대소문자 처리
  - 부분 문자열 검색
- [ ] 시간 범위 검색
  - 날짜 기반 필터링
  - 시간 구간 쿼리
  - 정렬 옵션
- [ ] 검색 결과 포맷팅

### 유효성 검사
- [ ] 검색어 검증
- [ ] 시간 형식 검증
- [ ] 결과 수 제한

### 테스트
- [ ] 검색 정확도 테스트
- [ ] 성능 벤치마크
- [ ] 빈 결과 처리
- [ ] 대용량 결과 처리

### 완료 기준
- [ ] 기본 검색 작동
- [ ] 응답 시간 < 100ms
- [ ] 검색 정확도 > 95%

---

## Phase 2 완료 체크리스트

### 산출물
- [ ] 시간 유틸리티 완성
- [ ] 데이터 모델 정의
- [ ] 메모리 엔진 구현
- [ ] Redis 연동 완료
- [ ] 기본 검색 기능

### 품질 지표
- [ ] 테스트 커버리지 > 85%
- [ ] 코드 품질 검사 통과
- [ ] API 문서화 완료
- [ ] 성능 벤치마크 달성

### 다음 단계
- [ ] Phase 3 준비사항 확인
- [ ] 통합 테스트 수행
- [ ] 리팩토링 필요사항 식별

---

작성일: 2025-05-27
작성자: 1호
버전: 2.0 (균형잡힌 체크리스트) ✨
