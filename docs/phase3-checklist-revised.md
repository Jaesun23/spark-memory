# LRMM Phase 3 체크리스트: MCP 서버 및 LangGraph 통합 (개정판)

> 기간: Week 2
> 목표: MCP 서버로 memory, state, system 명령어 노출 및 LangGraph 통합

## 사전 요구사항
- [ ] Phase 1, 2 완료 및 검증
- [ ] FastMCP 라이브러리 이해
- [ ] LangGraph 기본 개념 숙지
- [ ] MCP 프로토콜 기본 지식

---

## 단위작업 3.1: FastMCP 서버 초기화

### 목표
MCP 서버 기본 구조를 설정하고 3개 핵심 도구를 등록한다.

### 구현 사항
- [ ] `src/server.py` 생성
- [ ] FastMCP 앱 인스턴스 생성
- [ ] 서버 메타데이터 설정
  - name: "LRMM Memory Server"
  - version: semantic versioning
  - description: 서버 설명
- [ ] 로깅 시스템 구성
- [ ] 환경 변수 처리

### 유효성 검사
- [ ] MCP 서버 이름 규칙 준수
- [ ] 버전 형식 검증
- [ ] 의존성 버전 호환성

### 테스트
- [ ] 서버 임포트 가능
- [ ] FastMCP 인스턴스 생성
- [ ] 메타데이터 확인

### 완료 기준
- [ ] 서버 구조 완성
- [ ] 초기화 성공
- [ ] 로깅 작동 확인

---

## 단위작업 3.2: memory 도구 구현

### 목표
memory(action, paths, content, options) 도구를 MCP로 노출한다.

### 구현 사항
- [ ] @mcp.tool() 데코레이터로 등록
- [ ] 파라미터 정의
  - action: str (save, get, search, update, delete)
  - paths: List[str]
  - content: Optional[Any]
  - options: Optional[Dict]
- [ ] MemoryEngine 인스턴스 연결
- [ ] 응답 형식 표준화

### 유효성 검사
- [ ] 파라미터 타입 검증
- [ ] 액션 유효성 체크
- [ ] JSON 직렬화 가능성

### 테스트
- [ ] 도구 등록 확인
- [ ] 각 액션 호출 테스트
- [ ] 에러 처리 테스트

### 완료 기준
- [ ] memory 도구 작동
- [ ] 모든 액션 지원
- [ ] 에러 처리 완성

---

## 단위작업 3.3: state 도구 및 LangGraph 통합

### 목표
state(action, paths, content, options) 도구를 구현하고 LangGraph와 연동한다.

### 구현 사항
- [ ] StateManager 클래스 생성
- [ ] LangGraph 체크포인터 설정
  - RedisSaver 초기화
  - 체크포인트 스키마 정의
- [ ] state 도구 액션 구현
  - checkpoint: 상태 저장
  - restore: 상태 복원
  - list: 체크포인트 목록
  - status: 현재 상태
- [ ] LangGraph 에이전트 기본 구조
  - StateGraph 정의
  - 노드 및 엣지 설계
  - MCP 도구 연동

### 유효성 검사
- [ ] 상태 데이터 구조 검증
- [ ] LangGraph 호환성 확인
- [ ] 체크포인트 무결성

### 테스트
- [ ] 체크포인트 저장/복원
- [ ] LangGraph 에이전트 실행
- [ ] 상태 일관성 테스트

### 완료 기준
- [ ] state 도구 완성
- [ ] LangGraph 통합 작동
- [ ] 상태 관리 안정성

---

## 단위작업 3.4: system 도구 구현

### 목표
system(action, paths, content, options) 도구로 시스템 관리 기능을 제공한다.

### 구현 사항
- [ ] SystemManager 클래스 생성
- [ ] 시스템 액션 구현
  - status: 시스템 상태
  - backup: 백업 생성
  - clean: 정리 작업
  - config: 설정 관리
- [ ] Redis 모니터링 통합
- [ ] 시스템 메트릭 수집

### 유효성 검사
- [ ] 권한 검증 로직
- [ ] 작업 안전성 확인
- [ ] 설정 값 검증

### 테스트
- [ ] 상태 조회 정확성
- [ ] 백업/복원 시나리오
- [ ] 설정 변경 테스트

### 완료 기준
- [ ] system 도구 구현
- [ ] 모든 관리 기능 작동
- [ ] 보안 검증 완료

---

## 단위작업 3.5: MCP 서버 보안 강화

### 목표
MCP 서버의 보안을 강화하고 안전한 통신을 보장한다.

### 구현 사항
- [ ] 접근 제어 구현
  - API 키 인증
  - 요청 속도 제한
  - IP 화이트리스트 (선택)
- [ ] 입력 검증 강화
  - 파라미터 스키마 검증
  - SQL 인젝션 방지
  - 경로 탐색 공격 방지
- [ ] 로깅 및 감사
  - 모든 요청 로깅
  - 민감 정보 마스킹
  - 이상 행동 감지

### 유효성 검사
- [ ] 인증 메커니즘 작동
- [ ] 입력 필터링 효과
- [ ] 로그 무결성

### 테스트
- [ ] 인증 실패 시나리오
- [ ] 악의적 입력 차단
- [ ] 로그 추적 가능성

### 완료 기준
- [ ] 보안 체크리스트 통과
- [ ] 펜테스트 기본 항목 통과
- [ ] 보안 문서화 완료

---

## 단위작업 3.6: MCP 서버 실행 환경

### 목표
MCP 서버를 실행하고 Claude Desktop과 연동할 수 있도록 설정한다.

### 구현 사항
- [ ] 서버 진입점 구현
  - __main__ 블록
  - stdio 전송 설정
  - 비동기 이벤트 루프
- [ ] 환경 설정 관리
  - .env 파일 처리
  - 설정 우선순위
  - 기본값 정의
- [ ] Claude Desktop 설정
  - config.json 작성
  - 경로 설정
  - 환경 변수 전달

### 유효성 검사
- [ ] 실행 권한 확인
- [ ] 의존성 충족 여부
- [ ] 설정 파일 검증

### 테스트
- [ ] 서버 시작/종료
- [ ] stdio 통신 테스트
- [ ] Claude Desktop 연동
- [ ] 도구 호출 테스트

### 완료 기준
- [ ] 서버 안정적 실행
- [ ] Claude Desktop 통합
- [ ] 모든 도구 접근 가능

---

## Phase 3 완료 체크리스트

### 산출물
- [ ] MCP 서버 실행 파일
- [ ] 3개 핵심 도구 구현
- [ ] LangGraph 통합 완료
- [ ] 보안 시스템 구축
- [ ] Claude Desktop 설정

### 품질 지표
- [ ] MCP 프로토콜 100% 준수
- [ ] 도구 응답 시간 < 100ms
- [ ] 보안 취약점 0개
- [ ] 테스트 커버리지 > 85%

### 문서화
- [ ] MCP 도구 API 문서
- [ ] LangGraph 통합 가이드
- [ ] 보안 정책 문서
- [ ] 설정 가이드

### 다음 단계 준비
- [ ] Phase 4 요구사항 검토
- [ ] 성능 최적화 계획
- [ ] 사용자 피드백 준비

---

작성일: 2025-05-27
작성자: 1호
버전: 2.0 (LangGraph 통합 및 보안 강화) 🔒✨
